(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[610],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return m}});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),p=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),m=a,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||r;return n?o.createElement(h,i(i({ref:t},c),{},{components:n})):o.createElement(h,i({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var p=2;p<r;p++)i[p]=n[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6568:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},metadata:function(){return l},toc:function(){return p},default:function(){return u}});var o=n(2122),a=n(9756),r=(n(7294),n(3905)),i=["components"],s={title:"Run on Heroku and MongoDB Atlas",hide_title:!0,hide_table_of_contents:!1,description:"Instructions to setup fmdb on Heroku and MongoDB Atlas",keywords:["discord","moodle","bot"],slug:"/setup-with-heroku-mongodb-atlas"},l={unversionedId:"setup-with-heroku-and-mongodb-atlas",id:"setup-with-heroku-and-mongodb-atlas",isDocsHomePage:!1,title:"Run on Heroku and MongoDB Atlas",description:"Instructions to setup fmdb on Heroku and MongoDB Atlas",source:"@site/moodlebot/setup-with-heroku-and-mongodb-atlas.md",sourceDirName:".",slug:"/setup-with-heroku-mongodb-atlas",permalink:"/moodle-notification-service/2.0.0/setup-with-heroku-mongodb-atlas",editUrl:"https://github.com/tjarbo/documentation/tree/master/docs/moodlebot/moodlebot/setup-with-heroku-and-mongodb-atlas.md",version:"current",frontMatter:{title:"Run on Heroku and MongoDB Atlas",hide_title:!0,hide_table_of_contents:!1,description:"Instructions to setup fmdb on Heroku and MongoDB Atlas",keywords:["discord","moodle","bot"],slug:"/setup-with-heroku-mongodb-atlas"},sidebar:"tutorialSidebar",previous:{title:"Run on Docker",permalink:"/moodle-notification-service/2.0.0/setup-with-docker"},next:{title:"What is inside .env ?",permalink:"/moodle-notification-service/2.0.0/whats-inside-env"}},p=[{value:"\ud83d\ude80 Start your own bot with Heroku and MongoDB Atlas!",id:"-start-your-own-bot-with-heroku-and-mongodb-atlas",children:[{value:"Preparation",id:"preparation",children:[]},{value:"1. Setup you MongoDB",id:"1-setup-you-mongodb",children:[]},{value:"2. Get connection string from Atlas",id:"2-get-connection-string-from-atlas",children:[]},{value:"3. Update your environment variables",id:"3-update-your-environment-variables",children:[]},{value:"4. Create a new app on Heroku with just a click",id:"4-create-a-new-app-on-heroku-with-just-a-click",children:[]},{value:"\u2705 Yeah!",id:"-yeah",children:[]}]}],c={toc:p};function u(e){var t=e.components,n=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,o.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"-start-your-own-bot-with-heroku-and-mongodb-atlas"},"\ud83d\ude80 Start your own bot with Heroku and MongoDB Atlas!"),(0,r.kt)("p",null,"This article helps you to run your own fmdb on Heroku and MongoDB Atlas. Both products are useful as they are part of ",(0,r.kt)("a",{parentName:"p",href:"https://education.github.com/pack/"},"GitHub's education pack.")," \ud83c\udf89 So if you are a student or a pupil make sure, you checked it out! Because then you can run one ",(0,r.kt)("strong",{parentName:"p"},"Hobby Dyno")," for free, what ",(0,r.kt)("strong",{parentName:"p"},"is necessary for this use case.")),(0,r.kt)("p",null,"Before you start, follow the steps described ",(0,r.kt)("a",{parentName:"p",href:"/moodle-notification-service/2.0.0/setup-prepare"},"here"),"."),(0,r.kt)("h3",{id:"preparation"},"Preparation"),(0,r.kt)("p",null,"You need"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"an account on ",(0,r.kt)("a",{parentName:"li",href:"https://www.heroku.com"},"Heroku")),(0,r.kt)("li",{parentName:"ol"},"an account on ",(0,r.kt)("a",{parentName:"li",href:"https://www.mongodb.com/cloud/atlas"},"MongoDB Atlas")),(0,r.kt)("li",{parentName:"ol"},"a ",(0,r.kt)("inlineCode",{parentName:"li"},".env")," file from ",(0,r.kt)("a",{parentName:"li",href:"/moodle-notification-service/2.0.0/setup-prepare"},"these steps"),".")),(0,r.kt)("h3",{id:"1-setup-you-mongodb"},"1. Setup you MongoDB"),(0,r.kt)("p",null,"As this is a bit more complex, please follow the steps (parts) 1 to 4 of the official ",(0,r.kt)("a",{parentName:"p",href:"https://docs.atlas.mongodb.com/getting-started"},'"Get Started with Atlas"')," article. After you completed 1 to 4, came back here and continue your setup."),(0,r.kt)("p",null,"Please note for the single steps:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Part 1:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Choose 'MongoDB Atlas'"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Part 2:")," nothing :)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Part 3:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Click on ",(0,r.kt)("inlineCode",{parentName:"li"},"Allow access from everywhere"))))),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"}," ",(0,r.kt)("strong",{parentName:"p"},"Warning from ",(0,r.kt)("a",{parentName:"strong",href:"https://developer.mongodb.com/how-to/use-atlas-on-heroku"},"MongoDB Developer")),":  you probably don't want to allow this type of access in a production environment. Instead, you'll want to identify the exact IP addresses you know your application will be hosted on and explicitly set which IP addresses, or IP ranges, should have access to your cluster. After setting up your Heroku app, follow the steps in the \"Configuring Heroku IP Addresses in Atlas\" section below to see ",(0,r.kt)("em",{parentName:"p"},"how to add the proper IP addresses for your Heroku app.")))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Part 4:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Choose a username as you like :)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Choose a strong password!")," and keep it, you will need it during the next steps")))),(0,r.kt)("h3",{id:"2-get-connection-string-from-atlas"},"2. Get connection string from Atlas"),(0,r.kt)("p",null,'Now it\'s time to get the connection string you will need for the .env-variable "MONGO_HOST". It will look something like ',(0,r.kt)("inlineCode",{parentName:"p"},"mongodb+srv://<username>:<password>@clustername.mongodb.net/test?retryWrites=true&w=majority&useNewUrlParser=true&useUnifiedTopology=true"),"."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"In ",(0,r.kt)("em",{parentName:"li"},"Clusters")," view, click ",(0,r.kt)("strong",{parentName:"li"},"Connect")," for the cluster to which you want to connect."),(0,r.kt)("li",{parentName:"ol"},"In ",(0,r.kt)("em",{parentName:"li"},"Choose a connection method")," view, click ",(0,r.kt)("strong",{parentName:"li"},"Connect your application"),"."),(0,r.kt)("li",{parentName:"ol"},"Select ",(0,r.kt)("strong",{parentName:"li"},"Node.js")," from the ",(0,r.kt)("em",{parentName:"li"},"Driver")," dropdown."),(0,r.kt)("li",{parentName:"ol"},"Copy the provided connection string from the ",(0,r.kt)("strong",{parentName:"li"},"Connection String Only")," dialog tab."),(0,r.kt)("li",{parentName:"ol"},"Replace ",(0,r.kt)("inlineCode",{parentName:"li"},"<dbname>")," with ",(0,r.kt)("inlineCode",{parentName:"li"},"fmdb"),"."),(0,r.kt)("li",{parentName:"ol"},"Replace ",(0,r.kt)("inlineCode",{parentName:"li"},"<password>")," with the password from cluster setup :) (Not the password of your MongoDB Atlas account!)"),(0,r.kt)("li",{parentName:"ol"},"Save the link. You will need it during the next steps.")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},(0,r.kt)("strong",{parentName:"p"},"Note from ",(0,r.kt)("a",{parentName:"strong",href:"https://docs.atlas.mongodb.com/tutorial/connect-to-your-cluster"},"docs.atlas.mongodb.com"),":")," The connection string displayed in the console uses a placeholder value for the password. Replace that placeholder with the password specified when you created your database user."),(0,r.kt)("p",{parentName:"div"},"If the password contains reserved URI characters, you must escape the characters. For example, if your password is @bc123, you must escape the @ character when specifying the password in the connection string, such as %40bc123. To learn more, see Special characters in connection string password."))),(0,r.kt)("h3",{id:"3-update-your-environment-variables"},"3. Update your environment variables"),(0,r.kt)("p",null,"Open your ",(0,r.kt)("inlineCode",{parentName:"p"},".env")," file, set ",(0,r.kt)("inlineCode",{parentName:"p"},"MONGO_HOST=")," to the string you got from ",(0,r.kt)("a",{parentName:"p",href:"#1-setup-you-mongodb"},"step 1")," and append ",(0,r.kt)("inlineCode",{parentName:"p"},"&ssl=true")," at the end."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"...\nMONGO_HOST=mongodb+srv://mydatabaseuser:SuperS3cur3P4ssw0rd@fmdbcluster.hmxhr.mongodb.net/fmdb?retryWrites=true&w=majority&ssl=true\n...\n")),(0,r.kt)("h3",{id:"4-create-a-new-app-on-heroku-with-just-a-click"},"4. Create a new app on Heroku with just a click"),(0,r.kt)("p",null,"Click here:"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://heroku.com/deploy?template=https://github.com/heroku/node-js-getting-started"},(0,r.kt)("img",{parentName:"a",src:"https://www.herokucdn.com/deploy/button.svg",alt:"Deploy"}))),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Give your application a fancy name and choose your region"),(0,r.kt)("li",{parentName:"ol"},"Give it a name and fill all ",(0,r.kt)("em",{parentName:"li"},"empty")," environment variables with the values of your ",(0,r.kt)("inlineCode",{parentName:"li"},".env")," file."),(0,r.kt)("li",{parentName:"ol"},'Click "Deploy App" and see the magic happen \ud83d\udd2e\u2728')),(0,r.kt)("h3",{id:"-yeah"},"\u2705 Yeah!"),(0,r.kt)("p",null,"You have successfully deployed your own fmdb to heroku! Within the ",(0,r.kt)("em",{parentName:"p"},"build log")," you can find the url to access the admin panel."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},'When the fmdb freshly starts, the discord cache will be empty. Maybe as a spam bot protection, the bot is only able to send messages to users it already knows. Send the bot a small "test" message to add your admin (discord) account to bots cache.  '))))}u.isMDXComponent=!0}}]);